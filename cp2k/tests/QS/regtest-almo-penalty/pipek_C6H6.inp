&GLOBAL
  PROJECT C6H6
  RUN_TYPE ENERGY
  PRINT_LEVEL LOW
&END GLOBAL
&FORCE_EVAL
  METHOD QS
  &DFT
    BASIS_SET_FILE_NAME BASIS_MOLOPT
    POTENTIAL_FILE_NAME POTENTIAL
    &MGRID
      CUTOFF 600
      NGRIDS 4
    &END MGRID
    &QS
      ALMO_SCF T
      EPS_DEFAULT 1.0E-12
    &END QS

    &LOCALIZE
      METHOD NONE
      &PRINT
        &WANNIER_CUBES
        &END
      &END
    &END

    &ALMO_SCF

      EPS_FILTER                 1.0E-12
      ALMO_ALGORITHM             PCG
      MO_OVERLAP_INV_ALG         DENSE_CHOLESKY         
      DELOCALIZE_METHOD          FULL_SCF
      ALMO_SCF_GUESS             ATOMIC
      XALMO_TRIAL_WF             SIMPLE
      CONSTRUCT_NLMOS            T
      RETURN_ORTHOGONALIZED_MOS  .F.

      &ALMO_OPTIMIZER_PCG
        MAX_ITER                 30
        EPS_ERROR                1.0E-5
        CONJUGATOR               HESTENES_STIEFEL
        PRECONDITIONER           DEFAULT
        LIN_SEARCH_EPS_ERROR     0.05
        LIN_SEARCH_STEP_SIZE_GUESS 0.1
        MAX_ITER_OUTER_LOOP      50
        &PENALTY
          OCCUPIED_VOLUME_PENALTY_METHOD    NONE
          OCCUPIED_LOCALIZATION_PENALTY_METHOD  NONE
        &END PENALTY
      &END ALMO_OPTIMIZER_PCG

      &XALMO_OPTIMIZER_PCG
        MAX_ITER                 50
        EPS_ERROR                1.0E-5
        CONJUGATOR               HESTENES_STIEFEL
        PRECONDITIONER           DEFAULT
        LIN_SEARCH_EPS_ERROR     0.1
        LIN_SEARCH_STEP_SIZE_GUESS 0.2
        MAX_ITER_OUTER_LOOP      50
        &PENALTY
          OCCUPIED_VOLUME_PENALTY_METHOD    NONE
          OCCUPIED_LOCALIZATION_PENALTY_METHOD  NONE
        &END PENALTY
      &END XALMO_OPTIMIZER_PCG
      
      &NLMO_OPTIMIZER_PCG
        MAX_ITER                 20000
        EPS_ERROR                1.0E-3
        CONJUGATOR               HESTENES_STIEFEL
        PRECONDITIONER           NONE
        LIN_SEARCH_EPS_ERROR     0.001
        LIN_SEARCH_STEP_SIZE_GUESS 0.0001
        MAX_ITER_OUTER_LOOP      5
        &PENALTY
          OCCUPIED_VOLUME_PENALTY_METHOD    LNDET
          OPERATOR                          PIPEK
          OCCUPIED_VOLUME_PENALTY_COEFF     0.01
          DETERMINANT_ERROR                 1.0E-8
          VOLUME_PENALTY_COEFF_DECREASE_FACTOR  2.0
          OCCUPIED_LOCALIZATION_PENALTY_METHOD  NLMO
          LOCALIZATION_PENALTY_COEFF        1.0
          ENERGY_COEFF           0.0
          FINAL_DETERMINANT      0.1
        &END PENALTY
      &END NLMO_OPTIMIZER_PCG

    &END ALMO_SCF

    &SCF
      SCF_GUESS ATOMIC
      EPS_SCF 1.0E-7
      MAX_SCF 30
      &OT ON
        !ALGORITHM IRAC
        !MINIMIZER DIIS
        PRECONDITIONER FULL_ALL
      &END OT
      &OUTER_SCF
         EPS_SCF 1.0E-7
         MAX_SCF 5
      &END
      &PRINT
        &RESTART OFF
        &END
      &END
    &END SCF
    &XC
      &XC_FUNCTIONAL BLYP
      &END XC_FUNCTIONAL
    &END XC
  &END DFT
  &SUBSYS
    &CELL
      ABC 10.0 10.0 10.0
      MULTIPLE_UNIT_CELL 1 1 1
    &END CELL
    &TOPOLOGY
      MULTIPLE_UNIT_CELL 1 1 1
      &GENERATE
        CREATE_MOLECULES T
      &END GENERATE
    &END
    &COORD
C 3.5560000000 4.5610000000 5.0000000000
C 4.5060000000 3.5350000000 5.0000000000
C 5.8680000000 3.8450000000 5.0000000000
C 6.2820000000 5.1790000000 5.0000000000
C 5.3320000000 6.2050000000 5.0000000000
C 3.9700000000 5.8950000000 5.0000000000
H 2.5000000000 4.3210000000 5.0000000000
H 4.1850000000 2.5000000000 5.0000000000
H 6.6040000000 3.0490000000 5.0000000000
H 7.3390000000 5.4190000000 5.0000000000
H 5.6530000000 7.2400000000 5.0000000000
H 3.2340000000 6.6910000000 5.0000000000
    &END COORD
    &KIND C
      BASIS_SET TZV2P-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q4
    &END KIND
    &KIND H
      BASIS_SET TZV2P-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q1
    &END KIND
    &KIND O
      BASIS_SET TZV2P-MOLOPT-GTH
      POTENTIAL GTH-BLYP-q6
    &END KIND
  &END SUBSYS
&END FORCE_EVAL
